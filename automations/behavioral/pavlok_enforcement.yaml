# Behavioral Enforcement Automations
# Pavlok shock triggers based on zone occupancy booleans

- id: '1745371361598'
  alias: Couch Zone Shock - Live
  description: Shock if person is on couch and enforcement is enabled (with schedule support)
  triggers:
  - platform: state
    entity_id: input_boolean.couch_occupied
    to: 'on'
    for:
      seconds: 5
    id: person_sat_down
  - platform: state
    entity_id: input_boolean.couch_restricted
    to: 'on'
    id: restriction_enabled
  conditions:
  - condition: state
    entity_id: input_boolean.couch_occupied
    state: 'on'
  - condition: state
    entity_id: input_boolean.couch_restricted
    state: 'on'
  - condition: state
    entity_id: input_boolean.shocked
    state: 'off'
  actions:
  - repeat:
      while:
      - condition: state
        entity_id: input_boolean.couch_occupied
        state: 'on'
      - condition: state
        entity_id: input_boolean.couch_restricted
        state: 'on'
      sequence:
      - action: rest_command.pavlok_couch
        data: {}
      - target:
          entity_id: input_boolean.shocked
        action: input_boolean.turn_on
        data: {}
      - action: rest_command.habitica_lounge_negative
        data: {}
      - delay: 00:01:00
      - target:
          entity_id: input_boolean.shocked
        action: input_boolean.turn_off
        data: {}
  mode: single

- id: '1748993940939'
  alias: Bed Shock (Zone Enforcement - Toggle)
  description: Shock if person is in bed and enforcement is enabled (with schedule support)
  triggers:
  - platform: state
    entity_id: input_boolean.bed_occupied
    to: 'on'
    for:
      seconds: 5
    id: person_in_bed
  - platform: state
    entity_id: input_boolean.bed_restricted
    to: 'on'
    id: restriction_enabled
  conditions:
  - condition: state
    entity_id: input_boolean.bed_occupied
    state: 'on'
  - condition: state
    entity_id: input_boolean.bed_restricted
    state: 'on'
  - condition: state
    entity_id: input_boolean.shocked
    state: 'off'
  actions:
  - repeat:
      while:
      - condition: state
        entity_id: input_boolean.bed_occupied
        state: 'on'
      - condition: state
        entity_id: input_boolean.bed_restricted
        state: 'on'
      sequence:
      - action: rest_command.pavlok_bed
        data: {}
      - target:
          entity_id: input_boolean.shocked
        action: input_boolean.turn_on
        data: {}
      - action: rest_command.habitica_lounge_negative
        data: {}
      - delay: 00:01:00
      - target:
          entity_id: input_boolean.shocked
        action: input_boolean.turn_off
        data: {}
  mode: single
