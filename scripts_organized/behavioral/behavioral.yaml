morning_shock_loop:
  alias: Morning Shock Loop
  mode: restart
  variables:
    shock_count: 0
    max_shocks: 8
  sequence:
  - repeat:
      while:
      - condition: state
        entity_id: device_tracker.jamess_iphone
        state: home
      - condition: template
        value_template: '{{ repeat.index <= max_shocks }}'
      sequence:
      - variables:
          shock_intensity: '{% set level = repeat.index - 1 %} {% set base = 50 %} {% set increment = 10 %} {{ [base + (level * increment), 80] | min }}'
      - data:
          shock_value: '{{ shock_intensity }}'
        action: rest_command.pavlok_dynamic_shock
      - action: rest_command.habitica_lounge_negative
        metadata: {}
        data: {}
      - delay:
          minutes: 5
couch_shock_loop:
  alias: Couch Shock Loop
  mode: restart
  sequence:
  - repeat:
      while:
      - condition: state
        entity_id: input_boolean.couch_occupied
        state: 'on'
      sequence:
      - action: rest_command.pavlok_couch
        data: {}
      - delay:
          minutes: 1
  description: ''
bed_shock_loop:
  alias: Bed Shock Loop
  mode: restart
  sequence:
  - repeat:
      while:
      - condition: state
        entity_id: input_boolean.bed_occupied
        state: 'on'
      sequence:
      - action: rest_command.pavlok_bed
      - delay:
          minutes: 1
